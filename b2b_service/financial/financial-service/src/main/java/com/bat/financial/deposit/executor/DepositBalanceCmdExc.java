package com.bat.financial.deposit.executor;

import static com.bat.financial.deposit.executor.ErrorCode.B_DEPOSIT_BALANCE_DISTRIBUTOR_ERP_ID_NULL;

import java.math.BigDecimal;
import java.util.*;
import java.util.stream.Collectors;

import javax.annotation.Resource;

import org.apache.commons.lang3.SerializationUtils;
import org.apache.dubbo.config.annotation.DubboReference;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.util.CollectionUtils;

import com.alibaba.fastjson.JSON;
import com.bat.dubboapi.distributor.distributor.api.DistributorServiceRpc;
import com.bat.dubboapi.distributor.distributor.dto.data.DistributorNextNameRpcDTO;
import com.bat.dubboapi.thirdparty.erp.dto.financial.data.BalanceInfoDTO;
import com.bat.financial.api.base.FinancialException;
import com.bat.financial.dao.deposit.DepositDistributorMapper;
import com.bat.financial.dao.deposit.dataobject.DepositDistributorDO;
import com.bat.financial.dao.deposit.dataobject.DepositDistributorSubsidiaryBookDO;
import com.bat.financial.deposit.constant.ChangeType;
import com.bat.financial.deposit.constant.DepositBusinessType;
import com.bat.financial.pay.constant.PayWay;

import lombok.extern.slf4j.Slf4j;

/**
 * @author: lim
 * @description: 余额账户
 * @date: 2018/5/27 15:01
 */
@Component
@Slf4j
public class DepositBalanceCmdExc {

    @Resource
    private DepositDetailCmdExc depositDetailCmdExc;

    @Resource
    private DepositDistributorMapper depositDistributorMapper;

    @DubboReference(check = false, timeout = 30000)
    private DistributorServiceRpc distributorServiceRpc;

    /**
     * 新增余额账户 不返回
     *
     * @param aDo
     * @return
     */
    public boolean createNewDepositDistributor(DepositDistributorDO aDo) {
        createNewDepositDistributorAndReturn(aDo);
        return true;
    }

    /**
     * 新增余额账户 并返回
     *
     * @param aDo
     * @return
     */
    public DepositDistributorDO createNewDepositDistributorAndReturn(DepositDistributorDO aDo) {
        if (aDo != null) {
            if(aDo.getErpDistributorId() != null) {
                DepositDistributorDO byErpDistributorId =
                        depositDistributorMapper.getByErpDistributorId(aDo.getErpDistributorId());
                if (byErpDistributorId != null) {
                    throw FinancialException.buildException(ErrorCode.B_DEPOSIT_ERP_DISTRIBUTOR_EXISTS);
                }
            }
            depositDistributorMapper.insert(aDo);
        }
        return aDo;
    }

    /**
     * 根据分销商id 初始化余额账户（没有余额账户的情况下）
     *
     * @return
     */
    public DepositDistributorDO initNewDepositDistributor(Integer distributorId) {
        List<Integer> list = new ArrayList<>();
        list.add(distributorId);
        List<DistributorNextNameRpcDTO> rpcDTOS = distributorServiceRpc.getDistributorNextByDistributorIds(list);
        DistributorNextNameRpcDTO dto = null;
        if(!CollectionUtils.isEmpty(rpcDTOS)){
            dto = rpcDTOS.get(0);
        }
        if (dto != null) {
            if(dto.getErpId() == null){
                throw FinancialException.buildException(B_DEPOSIT_BALANCE_DISTRIBUTOR_ERP_ID_NULL);
            }
            return initNewDepositDistributor(dto.getId(), dto.getName(), String.valueOf(dto.getErpId()), dto.getTreeNode(),
                    dto.getDistributorAncestorId(), dto.getDistributorAncestorName());
        }else {
            return null;
        }
    }

    /**
     * 初始化余额账户 重载
     *
     * @param distributorId
     * @param distributorName
     * @param erpDistributorId
     * @param treeNode
     * @param distributorAncestorId
     * @param distributorAncestorName
     * @return
     */
    public DepositDistributorDO initNewDepositDistributor(Integer distributorId, String distributorName,
        String erpDistributorId, Integer treeNode, Integer distributorAncestorId, String distributorAncestorName) {
        Date date = new Date();
        DepositDistributorDO aDo = new DepositDistributorDO();
        aDo.setDistributorId(distributorId);
        aDo.setDistributorName(distributorName);
        aDo.setErpDistributorId(erpDistributorId);
        aDo.setTreeNode(treeNode);
        aDo.setDistributorAncestorId(distributorAncestorId);
        aDo.setDistributorAncestorName(distributorAncestorName);
        aDo.setAccountBalance(BigDecimal.ZERO);
        aDo.setAccountAvailable(BigDecimal.ZERO);
        aDo.setFreezingAmount(BigDecimal.ZERO);
        aDo.setRechargeAmount(BigDecimal.ZERO);
        aDo.setCommissionAmount(BigDecimal.ZERO);
        aDo.setWithdrawAmount(BigDecimal.ZERO);
        aDo.setConsumerAmount(BigDecimal.ZERO);
        aDo.setRefundAmount(BigDecimal.ZERO);
        aDo.setCreateTime(date);
        aDo.setUpdateTime(date);
        return aDo;
    }

    /**
     * 更新余额账户
     *
     * @param aDo
     * @return
     */
    public boolean updateDepositDistributor(DepositDistributorDO aDo) {
        DepositDistributorDO aDo1 = depositDistributorMapper.getByDistributorId(aDo.getDistributorId());
        if (aDo1 == null) {
            aDo1 = initNewDepositDistributor(aDo.getDistributorId());
            createNewDepositDistributor(aDo1);
        } else {
            depositDistributorMapper.updateByPrimaryKey(aDo);
        }
        return true;
    }

    public static void main(String[] args) {
        String a =
            "BalanceInfoDTO{FCUSTID='219530', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='219546', FZHYE=1006.0000000000}, BalanceInfoDTO{FCUSTID='219558', FZHYE=-29663.9100000000}, BalanceInfoDTO{FCUSTID='219599', FZHYE=-3218.0000000000}, BalanceInfoDTO{FCUSTID='219626', FZHYE=1774.0000000000}, BalanceInfoDTO{FCUSTID='219664', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='219665', FZHYE=147.1000000000}, BalanceInfoDTO{FCUSTID='219691', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='219731', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='219751', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='219778', FZHYE=160.0000000000}, BalanceInfoDTO{FCUSTID='219929', FZHYE=160.0000000000}, BalanceInfoDTO{FCUSTID='219931', FZHYE=0.1200000000}, BalanceInfoDTO{FCUSTID='251799', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='252186', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='339138', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='349084', FZHYE=-13592.0000000000}, BalanceInfoDTO{FCUSTID='842731', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='907508', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='908065', FZHYE=1.7200000000}, BalanceInfoDTO{FCUSTID='910126', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='914024', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='940069', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='964001', FZHYE=9.0000000000}, BalanceInfoDTO{FCUSTID='967703', FZHYE=1214.8700000000}, BalanceInfoDTO{FCUSTID='971072', FZHYE=1.2600000000}, BalanceInfoDTO{FCUSTID='977828', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='996329', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='996828', FZHYE=547.7800000000}, BalanceInfoDTO{FCUSTID='1024264', FZHYE=17.8700000000}, BalanceInfoDTO{FCUSTID='1037390', FZHYE=-376.9000000000}, BalanceInfoDTO{FCUSTID='1037539', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1050682', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1053211', FZHYE=38.8400000000}, BalanceInfoDTO{FCUSTID='1096749', FZHYE=360.0000000000}, BalanceInfoDTO{FCUSTID='1100172', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1103044', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1106849', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1118704', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1213415', FZHYE=135.0100000000}, BalanceInfoDTO{FCUSTID='1494386', FZHYE=-8785.4900000000}, BalanceInfoDTO{FCUSTID='1523650', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1590356', FZHYE=286.9200000000}, BalanceInfoDTO{FCUSTID='1630129', FZHYE=8.2200000000}, BalanceInfoDTO{FCUSTID='1635151', FZHYE=0.3900000000}, BalanceInfoDTO{FCUSTID='1650103', FZHYE=266.5700000000}, BalanceInfoDTO{FCUSTID='1689233', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1689511', FZHYE=37.0000000000}, BalanceInfoDTO{FCUSTID='1691609', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1707169', FZHYE=41.0000000000}, BalanceInfoDTO{FCUSTID='1713448', FZHYE=-7959.1800000000}, BalanceInfoDTO{FCUSTID='1714332', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1718634', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1719247', FZHYE=104.5000000000}, BalanceInfoDTO{FCUSTID='1720529', FZHYE=147.1500000000}, BalanceInfoDTO{FCUSTID='1721828', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1722911', FZHYE=48.0000000000}, BalanceInfoDTO{FCUSTID='1722915', FZHYE=1775.0000000000}, BalanceInfoDTO{FCUSTID='1723259', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1727423', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1727800', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1728496', FZHYE=-12.0000000000}, BalanceInfoDTO{FCUSTID='1728497', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1735040', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1735341', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1735433', FZHYE=-916.0000000000}, BalanceInfoDTO{FCUSTID='1735638', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1739696', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1744672', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1760219', FZHYE=-4293.0000000000}, BalanceInfoDTO{FCUSTID='1768941', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1769495', FZHYE=-199.6000000000}, BalanceInfoDTO{FCUSTID='1770093', FZHYE=-94697.0000000000}, BalanceInfoDTO{FCUSTID='1860731', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1861201', FZHYE=84.9500000000}, BalanceInfoDTO{FCUSTID='1861441', FZHYE=14.4000000000}, BalanceInfoDTO{FCUSTID='1876504', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1926484', FZHYE=-108.6000000000}, BalanceInfoDTO{FCUSTID='1930233', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1977401', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='1989225', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2028254', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2029278', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2032007', FZHYE=160.0000000000}, BalanceInfoDTO{FCUSTID='2032009', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2056018', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2086442', FZHYE=111.6500000000}, BalanceInfoDTO{FCUSTID='2087205', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2090111', FZHYE=0.5800000000}, BalanceInfoDTO{FCUSTID='2156217', FZHYE=187.0000000000}, BalanceInfoDTO{FCUSTID='2180453', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2209192', FZHYE=1295.4200000000}, BalanceInfoDTO{FCUSTID='2271763', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2330944', FZHYE=-6563.1400000000}, BalanceInfoDTO{FCUSTID='2340054', FZHYE=0.0800000000}, BalanceInfoDTO{FCUSTID='2362240', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2402198', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2447977', FZHYE=1930.0000000000}, BalanceInfoDTO{FCUSTID='2449791', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2497455', FZHYE=94.2100000000}, BalanceInfoDTO{FCUSTID='2509666', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2519563', FZHYE=1423.2600000000}, BalanceInfoDTO{FCUSTID='2519566', FZHYE=-15.0000000000}, BalanceInfoDTO{FCUSTID='2519668', FZHYE=2098.7500000000}, BalanceInfoDTO{FCUSTID='2519864', FZHYE=2540.8900000000}, BalanceInfoDTO{FCUSTID='2519898', FZHYE=579.0000000000}, BalanceInfoDTO{FCUSTID='2520160', FZHYE=-4262.2400000000}, BalanceInfoDTO{FCUSTID='2520237', FZHYE=22000.3000000000}, BalanceInfoDTO{FCUSTID='2520856', FZHYE=1159.0000000000}, BalanceInfoDTO{FCUSTID='2520865', FZHYE=119.0000000000}, BalanceInfoDTO{FCUSTID='2520889', FZHYE=2573.7300000000}, BalanceInfoDTO{FCUSTID='2520890', FZHYE=2196.0000000000}, BalanceInfoDTO{FCUSTID='2522662', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2532321', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2532325', FZHYE=354.2600000000}, BalanceInfoDTO{FCUSTID='2549724', FZHYE=1001.5800000000}, BalanceInfoDTO{FCUSTID='2549725', FZHYE=1528.7200000000}, BalanceInfoDTO{FCUSTID='2549726', FZHYE=25314.6300000000}, BalanceInfoDTO{FCUSTID='2560949', FZHYE=1421.8100000000}, BalanceInfoDTO{FCUSTID='2561205', FZHYE=7.6600000000}, BalanceInfoDTO{FCUSTID='2561537', FZHYE=18.4000000000}, BalanceInfoDTO{FCUSTID='2587090', FZHYE=29.9000000000}, BalanceInfoDTO{FCUSTID='2587104', FZHYE=843.3600000000}, BalanceInfoDTO{FCUSTID='2587135', FZHYE=6.5400000000}, BalanceInfoDTO{FCUSTID='2587151', FZHYE=2.0200000000}, BalanceInfoDTO{FCUSTID='2587159', FZHYE=29.7400000000}, BalanceInfoDTO{FCUSTID='2587169', FZHYE=21.9700000000}, BalanceInfoDTO{FCUSTID='2588571', FZHYE=125.0000000000}, BalanceInfoDTO{FCUSTID='2588743', FZHYE=63.2100000000}, BalanceInfoDTO{FCUSTID='2588745', FZHYE=5.6100000000}, BalanceInfoDTO{FCUSTID='2589389', FZHYE=-138.3000000000}, BalanceInfoDTO{FCUSTID='2629291', FZHYE=132.9500000000}, BalanceInfoDTO{FCUSTID='2629296', FZHYE=895.4900000000}, BalanceInfoDTO{FCUSTID='2629299', FZHYE=-164.0200000000}, BalanceInfoDTO{FCUSTID='2629301', FZHYE=-1323.0500000000}, BalanceInfoDTO{FCUSTID='2629303', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2629305', FZHYE=17.2900000000}, BalanceInfoDTO{FCUSTID='2629309', FZHYE=12018.1000000000}, BalanceInfoDTO{FCUSTID='2629310', FZHYE=1857.8300000000}, BalanceInfoDTO{FCUSTID='2629311', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2629315', FZHYE=3243.8100000000}, BalanceInfoDTO{FCUSTID='2629318', FZHYE=3582.0000000000}, BalanceInfoDTO{FCUSTID='2630612', FZHYE=3576.6600000000}, BalanceInfoDTO{FCUSTID='2630649', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2630661', FZHYE=3565.6200000000}, BalanceInfoDTO{FCUSTID='2630679', FZHYE=-1354.8400000000}, BalanceInfoDTO{FCUSTID='2630691', FZHYE=-49.9100000000}, BalanceInfoDTO{FCUSTID='2630713', FZHYE=254.0000000000}, BalanceInfoDTO{FCUSTID='2630725', FZHYE=1273.4900000000}, BalanceInfoDTO{FCUSTID='2631573', FZHYE=1456.7500000000}, BalanceInfoDTO{FCUSTID='2631580', FZHYE=-225.9400000000}, BalanceInfoDTO{FCUSTID='2631754', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2631755', FZHYE=402.0700000000}, BalanceInfoDTO{FCUSTID='2637408', FZHYE=4379.1000000000}, BalanceInfoDTO{FCUSTID='2637410', FZHYE=1498.0000000000}, BalanceInfoDTO{FCUSTID='2637415', FZHYE=1721.4000000000}, BalanceInfoDTO{FCUSTID='2637418', FZHYE=92.7000000000}, BalanceInfoDTO{FCUSTID='2637420', FZHYE=2661.7300000000}, BalanceInfoDTO{FCUSTID='2638944', FZHYE=1107.3900000000}, BalanceInfoDTO{FCUSTID='2638945', FZHYE=3290.4800000000}, BalanceInfoDTO{FCUSTID='2638946', FZHYE=1042.8600000000}, BalanceInfoDTO{FCUSTID='2639047', FZHYE=2927.0000000000}, BalanceInfoDTO{FCUSTID='2639050', FZHYE=-17230.3100000000}, BalanceInfoDTO{FCUSTID='2639051', FZHYE=861.8000000000}, BalanceInfoDTO{FCUSTID='2639054', FZHYE=700.1700000000}, BalanceInfoDTO{FCUSTID='2639256', FZHYE=1596.0000000000}, BalanceInfoDTO{FCUSTID='2639292', FZHYE=912.0600000000}, BalanceInfoDTO{FCUSTID='2639319', FZHYE=3682.5000000000}, BalanceInfoDTO{FCUSTID='2639378', FZHYE=1061.2300000000}, BalanceInfoDTO{FCUSTID='2639417', FZHYE=12460.2600000000}, BalanceInfoDTO{FCUSTID='2639428', FZHYE=1194.7500000000}, BalanceInfoDTO{FCUSTID='2639938', FZHYE=330.0000000000}, BalanceInfoDTO{FCUSTID='2639942', FZHYE=74.6900000000}, BalanceInfoDTO{FCUSTID='2640262', FZHYE=504.1200000000}, BalanceInfoDTO{FCUSTID='2640271', FZHYE=1600.0000000000}, BalanceInfoDTO{FCUSTID='2640427', FZHYE=1405.4500000000}, BalanceInfoDTO{FCUSTID='2641501', FZHYE=5897.3900000000}, BalanceInfoDTO{FCUSTID='2642545', FZHYE=130.0000000000}, BalanceInfoDTO{FCUSTID='2642551', FZHYE=3269.3200000000}, BalanceInfoDTO{FCUSTID='2642556', FZHYE=309.0300000000}, BalanceInfoDTO{FCUSTID='2642560', FZHYE=61.1900000000}, BalanceInfoDTO{FCUSTID='2642595', FZHYE=-181.5000000000}, BalanceInfoDTO{FCUSTID='2646490', FZHYE=1166.0000000000}, BalanceInfoDTO{FCUSTID='2646491', FZHYE=-2005.9400000000}, BalanceInfoDTO{FCUSTID='2646492', FZHYE=1178.3500000000}, BalanceInfoDTO{FCUSTID='2646493', FZHYE=-3736.2700000000}, BalanceInfoDTO{FCUSTID='2646507', FZHYE=-94.4900000000}, BalanceInfoDTO{FCUSTID='2648182', FZHYE=-175.8800000000}, BalanceInfoDTO{FCUSTID='2648183', FZHYE=26.6100000000}, BalanceInfoDTO{FCUSTID='2648184', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2648185', FZHYE=15.3700000000}, BalanceInfoDTO{FCUSTID='2648186', FZHYE=-263.9800000000}, BalanceInfoDTO{FCUSTID='2648913', FZHYE=-638.4400000000}, BalanceInfoDTO{FCUSTID='2648918', FZHYE=69.9000000000}, BalanceInfoDTO{FCUSTID='2648925', FZHYE=-478.0000000000}, BalanceInfoDTO{FCUSTID='2648932', FZHYE=-299.6000000000}, BalanceInfoDTO{FCUSTID='2648938', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2648946', FZHYE=2267.8000000000}, BalanceInfoDTO{FCUSTID='2648989', FZHYE=23.4200000000}, BalanceInfoDTO{FCUSTID='2650055', FZHYE=-1091.6200000000}, BalanceInfoDTO{FCUSTID='2650067', FZHYE=146.2500000000}, BalanceInfoDTO{FCUSTID='2650078', FZHYE=44166.4500000000}, BalanceInfoDTO{FCUSTID='2650085', FZHYE=2046.6400000000}, BalanceInfoDTO{FCUSTID='2650090', FZHYE=1450.4900000000}, BalanceInfoDTO{FCUSTID='2650094', FZHYE=2945.9300000000}, BalanceInfoDTO{FCUSTID='2650097', FZHYE=2467.5800000000}, BalanceInfoDTO{FCUSTID='2650101', FZHYE=326.9300000000}, BalanceInfoDTO{FCUSTID='2650104', FZHYE=-2160.4000000000}, BalanceInfoDTO{FCUSTID='2650107', FZHYE=34.7900000000}, BalanceInfoDTO{FCUSTID='2656283', FZHYE=4133.2500000000}, BalanceInfoDTO{FCUSTID='2656290', FZHYE=357.4000000000}, BalanceInfoDTO{FCUSTID='2656296', FZHYE=4781.8400000000}, BalanceInfoDTO{FCUSTID='2656302', FZHYE=1596.3000000000}, BalanceInfoDTO{FCUSTID='2656306', FZHYE=1011.1400000000}, BalanceInfoDTO{FCUSTID='2656313', FZHYE=1959.0000000000}, BalanceInfoDTO{FCUSTID='2656319', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2659574', FZHYE=2816.8000000000}, BalanceInfoDTO{FCUSTID='2659575', FZHYE=61.6300000000}, BalanceInfoDTO{FCUSTID='2659576', FZHYE=-2262.8100000000}, BalanceInfoDTO{FCUSTID='2659577', FZHYE=362.0700000000}, BalanceInfoDTO{FCUSTID='2660889', FZHYE=505.4500000000}, BalanceInfoDTO{FCUSTID='2660891', FZHYE=1327.6000000000}, BalanceInfoDTO{FCUSTID='2660892', FZHYE=984.0000000000}, BalanceInfoDTO{FCUSTID='2660893', FZHYE=3335.6600000000}, BalanceInfoDTO{FCUSTID='2660894', FZHYE=1398.8100000000}, BalanceInfoDTO{FCUSTID='2660895', FZHYE=886.4400000000}, BalanceInfoDTO{FCUSTID='2661909', FZHYE=-31.2000000000}, BalanceInfoDTO{FCUSTID='2661979', FZHYE=5786.4000000000}, BalanceInfoDTO{FCUSTID='2661995', FZHYE=2094.0000000000}, BalanceInfoDTO{FCUSTID='2662054', FZHYE=-588.0700000000}, BalanceInfoDTO{FCUSTID='2662064', FZHYE=-195.3600000000}, BalanceInfoDTO{FCUSTID='2662081', FZHYE=17511.5000000000}, BalanceInfoDTO{FCUSTID='2662589', FZHYE=1734.0000000000}, BalanceInfoDTO{FCUSTID='2666602', FZHYE=4711.1300000000}, BalanceInfoDTO{FCUSTID='2666603', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2666604', FZHYE=1428.0200000000}, BalanceInfoDTO{FCUSTID='2668614', FZHYE=586.0300000000}, BalanceInfoDTO{FCUSTID='2669308', FZHYE=302.4200000000}, BalanceInfoDTO{FCUSTID='2669341', FZHYE=-675.7800000000}, BalanceInfoDTO{FCUSTID='2669589', FZHYE=-2896.8000000000}, BalanceInfoDTO{FCUSTID='2670644', FZHYE=-41.7300000000}, BalanceInfoDTO{FCUSTID='2671905', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2674634', FZHYE=22.2900000000}, BalanceInfoDTO{FCUSTID='2674638', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2674640', FZHYE=21472.7800000000}, BalanceInfoDTO{FCUSTID='2674642', FZHYE=2630.3300000000}, BalanceInfoDTO{FCUSTID='2689030', FZHYE=11769.0000000000}, BalanceInfoDTO{FCUSTID='2689034', FZHYE=-990.3600000000}, BalanceInfoDTO{FCUSTID='2689037', FZHYE=182.6800000000}, BalanceInfoDTO{FCUSTID='2689041', FZHYE=345.0000000000}, BalanceInfoDTO{FCUSTID='2696088', FZHYE=3020.5300000000}, BalanceInfoDTO{FCUSTID='2696091', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2702140', FZHYE=888.3500000000}, BalanceInfoDTO{FCUSTID='2702141', FZHYE=-648.8900000000}, BalanceInfoDTO{FCUSTID='2702142', FZHYE=30.0000000000}, BalanceInfoDTO{FCUSTID='2709573', FZHYE=17.3000000000}, BalanceInfoDTO{FCUSTID='2709916', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2711013', FZHYE=575.8400000000}, BalanceInfoDTO{FCUSTID='2733493', FZHYE=1027.8600000000}, BalanceInfoDTO{FCUSTID='2733494', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2733933', FZHYE=-379.2000000000}, BalanceInfoDTO{FCUSTID='2759138', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2759598', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2764463', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2767641', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2805142', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2805143', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2805144', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2813287', FZHYE=88.0400000000}, BalanceInfoDTO{FCUSTID='2820249', FZHYE=152.9600000000}, BalanceInfoDTO{FCUSTID='2821088', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2823695', FZHYE=7.0500000000}, BalanceInfoDTO{FCUSTID='2828794', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2838711', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2859832', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2863690', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2868293', FZHYE=-0.0300000000}, BalanceInfoDTO{FCUSTID='2868294', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2868300', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2868489', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2868493', FZHYE=120.0000000000}, BalanceInfoDTO{FCUSTID='2890586', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2890597', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2890717', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2901786', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2904832', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2911438', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2912154', FZHYE=565.0000000000}, BalanceInfoDTO{FCUSTID='2913221', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2915729', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2928072', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2928075', FZHYE=2056.4000000000}, BalanceInfoDTO{FCUSTID='2933517', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2944561', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2944630', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2954940', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2955614', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2964646', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2964656', FZHYE=554.8300000000}, BalanceInfoDTO{FCUSTID='2966176', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2966517', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='2977695', FZHYE=788.0000000000}, BalanceInfoDTO{FCUSTID='3005050', FZHYE=231.0000000000}, BalanceInfoDTO{FCUSTID='3009539', FZHYE=5.0000000000}, BalanceInfoDTO{FCUSTID='3009582', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3012014', FZHYE=5.6000000000}, BalanceInfoDTO{FCUSTID='3015896', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3015904', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3019915', FZHYE=15000.0000000000}, BalanceInfoDTO{FCUSTID='3019927', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3020375', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3043171', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3046146', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3046182', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3047246', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3047329', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3047481', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3054332', FZHYE=22.6800000000}, BalanceInfoDTO{FCUSTID='3054333', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3054336', FZHYE=1270.0400000000}, BalanceInfoDTO{FCUSTID='3058253', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3075112', FZHYE=0.0600000000}, BalanceInfoDTO{FCUSTID='3082797', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3083489', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3087365', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3107738', FZHYE=951.2600000000}, BalanceInfoDTO{FCUSTID='3119842', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3119844', FZHYE=135.0000000000}, BalanceInfoDTO{FCUSTID='3119847', FZHYE=50.0000000000}, BalanceInfoDTO{FCUSTID='3119853', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3150712', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3159551', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3162275', FZHYE=-2926.4500000000}, BalanceInfoDTO{FCUSTID='3164726', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3165278', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3165428', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3167640', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3186004', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3204602', FZHYE=0.0500000000}, BalanceInfoDTO{FCUSTID='3213434', FZHYE=0.1900000000}, BalanceInfoDTO{FCUSTID='3237427', FZHYE=150.0100000000}, BalanceInfoDTO{FCUSTID='3239251', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3241594', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3242538', FZHYE=-26.0000000000}, BalanceInfoDTO{FCUSTID='3243094', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3250659', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3255773', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3257896', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3257933', FZHYE=1416.6000000000}, BalanceInfoDTO{FCUSTID='3281584', FZHYE=-10566.0000000000}, BalanceInfoDTO{FCUSTID='3298077', FZHYE=346.4600000000}, BalanceInfoDTO{FCUSTID='3298585', FZHYE=3089.0000000000}, BalanceInfoDTO{FCUSTID='3304213', FZHYE=104.3900000000}, BalanceInfoDTO{FCUSTID='3311486', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3337037', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3355033', FZHYE=10.0000000000}, BalanceInfoDTO{FCUSTID='3355042', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3356622', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3378104', FZHYE=128.0000000000}, BalanceInfoDTO{FCUSTID='3381627', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3420578', FZHYE=55.0000000000}, BalanceInfoDTO{FCUSTID='3423092', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3426048', FZHYE=1117.0000000000}, BalanceInfoDTO{FCUSTID='3426399', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3426492', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3426625', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3430746', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3432650', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3444023', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3444217', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3468400', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3474062', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3478876', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3480646', FZHYE=109.7800000000}, BalanceInfoDTO{FCUSTID='3480662', FZHYE=910.0000000000}, BalanceInfoDTO{FCUSTID='3489315', FZHYE=413.8000000000}, BalanceInfoDTO{FCUSTID='3490159', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3544076', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3544117', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3553778', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3558468', FZHYE=-778.8900000000}, BalanceInfoDTO{FCUSTID='3560439', FZHYE=743.8200000000}, BalanceInfoDTO{FCUSTID='3627265', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3708937', FZHYE=23.0700000000}, BalanceInfoDTO{FCUSTID='3716135', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3718523', FZHYE=36.0000000000}, BalanceInfoDTO{FCUSTID='3742630', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3757446', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3762102', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3762177', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3762288', FZHYE=460.4100000000}, BalanceInfoDTO{FCUSTID='3775200', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3781579', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3782806', FZHYE=964.0000000000}, BalanceInfoDTO{FCUSTID='3784280', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3788065', FZHYE=11932.0000000000}, BalanceInfoDTO{FCUSTID='3788094', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='3793641', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3794870', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3802800', FZHYE=90.0000000000}, BalanceInfoDTO{FCUSTID='3802858', FZHYE=-305.6000000000}, BalanceInfoDTO{FCUSTID='3823447', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3823587', FZHYE=0.5000000000}, BalanceInfoDTO{FCUSTID='3845577', FZHYE=-330.7900000000}, BalanceInfoDTO{FCUSTID='3845635', FZHYE=40.0000000000}, BalanceInfoDTO{FCUSTID='3845823', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3848268', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3853500', FZHYE=-201.2000000000}, BalanceInfoDTO{FCUSTID='3857265', FZHYE=9.0100000000}, BalanceInfoDTO{FCUSTID='3860846', FZHYE=3522.0000000000}, BalanceInfoDTO{FCUSTID='3878132', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3883756', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3883757', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3883799', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3899318', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3908441', FZHYE=405.7900000000}, BalanceInfoDTO{FCUSTID='3909067', FZHYE=2950.2100000000}, BalanceInfoDTO{FCUSTID='3936306', FZHYE=33.5000000000}, BalanceInfoDTO{FCUSTID='3936323', FZHYE=329.3200000000}, BalanceInfoDTO{FCUSTID='3949130', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3951534', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3957660', FZHYE=173.8500000000}, BalanceInfoDTO{FCUSTID='3971887', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3972099', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3972119', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3975197', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3975611', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3985009', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='3985091', FZHYE=2034.0000000000}, BalanceInfoDTO{FCUSTID='3994843', FZHYE=37.3000000000}, BalanceInfoDTO{FCUSTID='3997296', FZHYE=-220.5000000000}, BalanceInfoDTO{FCUSTID='4003451', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4009608', FZHYE=-3411.0000000000}, BalanceInfoDTO{FCUSTID='4033569', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4037958', FZHYE=174.0000000000}, BalanceInfoDTO{FCUSTID='4040878', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4043362', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4046797', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4050480', FZHYE=3449.5600000000}, BalanceInfoDTO{FCUSTID='4057440', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4083204', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4088725', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4094018', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4120134', FZHYE=520.4000000000}, BalanceInfoDTO{FCUSTID='4127184', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4140413', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4174384', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4176524', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4180620', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4181296', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4189698', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4191414', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4208877', FZHYE=367.3900000000}, BalanceInfoDTO{FCUSTID='4210451', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4210582', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4218124', FZHYE=6024.5200000000}, BalanceInfoDTO{FCUSTID='4230391', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4234499', FZHYE=5.0000000000}, BalanceInfoDTO{FCUSTID='4246367', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4246368', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4247193', FZHYE=5.6000000000}, BalanceInfoDTO{FCUSTID='4247201', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4247205', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4247275', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4247537', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4247824', FZHYE=150.0100000000}, BalanceInfoDTO{FCUSTID='4248806', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4248809', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4249076', FZHYE=18.0000000000}, BalanceInfoDTO{FCUSTID='4249448', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4249534', FZHYE=661.5800000000}, BalanceInfoDTO{FCUSTID='4249696', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4249971', FZHYE=25.0000000000}, BalanceInfoDTO{FCUSTID='4250391', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4250931', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4250941', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4251003', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4253237', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4253238', FZHYE=1.4000000000}, BalanceInfoDTO{FCUSTID='4253240', FZHYE=18.0000000000}, BalanceInfoDTO{FCUSTID='4253243', FZHYE=711.6000000000}, BalanceInfoDTO{FCUSTID='4254171', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4254178', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4254474', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4255257', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4255408', FZHYE=0.9900000000}, BalanceInfoDTO{FCUSTID='4255420', FZHYE=30.7000000000}, BalanceInfoDTO{FCUSTID='4255546', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4255549', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4255648', FZHYE=54.0000000000}, BalanceInfoDTO{FCUSTID='4255796', FZHYE=656.0100000000}, BalanceInfoDTO{FCUSTID='4256066', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4256145', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4256220', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4256924', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4256937', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257012', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257073', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257165', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257273', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='4257328', FZHYE=27.0200000000}, BalanceInfoDTO{FCUSTID='4257362', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257456', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257850', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257936', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257964', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4257983', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4260523', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4260525', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4260839', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4260913', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4261024', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4261620', FZHYE=0.8200000000}, BalanceInfoDTO{FCUSTID='4261718', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4261771', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4261850', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262271', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262480', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262517', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262541', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262558', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262616', FZHYE=24.9800000000}, BalanceInfoDTO{FCUSTID='4262683', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262874', FZHYE=18.0100000000}, BalanceInfoDTO{FCUSTID='4262901', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4262972', FZHYE=-306.0800000000}, BalanceInfoDTO{FCUSTID='4263095', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4263909', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4263959', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4266164', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4266318', FZHYE=-3956.9900000000}, BalanceInfoDTO{FCUSTID='4266327', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4266329', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4266331', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='4266333', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4267508', FZHYE=169.4000000000}, BalanceInfoDTO{FCUSTID='4267509', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4267898', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4267904', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4268406', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4269803', FZHYE=186.0000000000}, BalanceInfoDTO{FCUSTID='4271045', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271046', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271047', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271048', FZHYE=9.0200000000}, BalanceInfoDTO{FCUSTID='4271053', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271674', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271676', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271684', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4271689', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272429', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272435', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272436', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272437', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272467', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272478', FZHYE=399.5500000000}, BalanceInfoDTO{FCUSTID='4272546', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4272547', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='4273004', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273018', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273046', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273050', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273062', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273069', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273642', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273948', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273950', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4273951', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4274399', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4274406', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4274411', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4274882', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4275262', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='4277213', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277214', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277215', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277216', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277229', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277231', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277237', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277238', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277242', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4277243', FZHYE=0.4900000000}, BalanceInfoDTO{FCUSTID='4283391', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4283916', FZHYE=150.0500000000}, BalanceInfoDTO{FCUSTID='4283931', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4283939', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4283949', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4284083', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4284086', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4284087', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4284124', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4286423', FZHYE=117.0000000000}, BalanceInfoDTO{FCUSTID='4286425', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4286427', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4286432', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4286658', FZHYE=9.0100000000}, BalanceInfoDTO{FCUSTID='4286674', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4286711', FZHYE=9.0000000000}, BalanceInfoDTO{FCUSTID='4287130', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4287218', FZHYE=12.2100000000}, BalanceInfoDTO{FCUSTID='4287228', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4287240', FZHYE=13.5800000000}, BalanceInfoDTO{FCUSTID='4287360', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4287663', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4287676', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4287688', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288274', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288291', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288399', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288468', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288473', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288476', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288523', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288927', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288934', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4288941', FZHYE=9.7700000000}, BalanceInfoDTO{FCUSTID='4289276', FZHYE=256.9000000000}, BalanceInfoDTO{FCUSTID='4289545', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4289547', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4289548', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4289550', FZHYE=9.0000000000}, BalanceInfoDTO{FCUSTID='4289594', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292094', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292097', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292101', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292103', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292280', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292282', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292286', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292289', FZHYE=0.4200000000}, BalanceInfoDTO{FCUSTID='4292290', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292294', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292300', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292325', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292946', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4292975', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4293531', FZHYE=150.0100000000}, BalanceInfoDTO{FCUSTID='4293532', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4293537', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4293658', FZHYE=159.0100000000}, BalanceInfoDTO{FCUSTID='4293852', FZHYE=-1218.7000000000}, BalanceInfoDTO{FCUSTID='4294660', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4297445', FZHYE=-64000.0000000000}, BalanceInfoDTO{FCUSTID='4297555', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4297634', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4297697', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4298861', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4298917', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4302910', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4302958', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4303733', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4303895', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4305123', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4305287', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4316066', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4316067', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4324164', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4327601', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4327656', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4327700', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4328096', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4328150', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4328524', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4330825', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4336962', FZHYE=-74.6400000000}, BalanceInfoDTO{FCUSTID='4344280', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4344283', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4345020', FZHYE=14.6000000000}, BalanceInfoDTO{FCUSTID='4345704', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4349751', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4350878', FZHYE=444.0000000000}, BalanceInfoDTO{FCUSTID='4352157', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4352272', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4352759', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4352763', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4357506', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4357614', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4365637', FZHYE=-6392.1000000000}, BalanceInfoDTO{FCUSTID='4365673', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4365674', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='4365849', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4373043', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4375219', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4380825', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4405058', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4405329', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4405330', FZHYE=666.9500000000}, BalanceInfoDTO{FCUSTID='4408165', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4415330', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4418776', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4418878', FZHYE=380.0000000000}, BalanceInfoDTO{FCUSTID='4430497', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4430500', FZHYE=6892.8000000000}, BalanceInfoDTO{FCUSTID='4430514', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4430655', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4431227', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4431283', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4431888', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4432000', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4437436', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4437693', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4439401', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4445828', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4447138', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4447472', FZHYE=27.0000000000}, BalanceInfoDTO{FCUSTID='4447508', FZHYE=-435.7900000000}, BalanceInfoDTO{FCUSTID='4448338', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='4448480', FZHYE=66.4100000000}, BalanceInfoDTO{FCUSTID='4449178', FZHYE=30.2000000000}, BalanceInfoDTO{FCUSTID='4449200', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4452062', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4453359', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4453633', FZHYE=-450.0000000000}, BalanceInfoDTO{FCUSTID='4457647', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4457648', FZHYE=18.0000000000}, BalanceInfoDTO{FCUSTID='4459163', FZHYE=3739.0100000000}, BalanceInfoDTO{FCUSTID='4461662', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4495126', FZHYE=12.5100000000}, BalanceInfoDTO{FCUSTID='4495127', FZHYE=5.6000000000}, BalanceInfoDTO{FCUSTID='4496145', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4496860', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4511605', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4521093', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4536119', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4536124', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4536529', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4540848', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4543740', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4561500', FZHYE=0.2700000000}, BalanceInfoDTO{FCUSTID='4562132', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4565565', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4572735', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4579161', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4579210', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4588660', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4619773', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4623253', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4675842', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4683479', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4684406', FZHYE=0.2900000000}, BalanceInfoDTO{FCUSTID='4698267', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4718737', FZHYE=0.9200000000}, BalanceInfoDTO{FCUSTID='4750077', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4759374', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4798132', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4808237', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4808861', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4840677', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4845625', FZHYE=481.5700000000}, BalanceInfoDTO{FCUSTID='4845673', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4856087', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4856634', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4856710', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4860375', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4866405', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4868019', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4869709', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4885103', FZHYE=1354.9300000000}, BalanceInfoDTO{FCUSTID='4885419', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4885814', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4923440', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4923679', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4925431', FZHYE=-34.7400000000}, BalanceInfoDTO{FCUSTID='4928056', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4940348', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4942859', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4942879', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4953119', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4953159', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4954604', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4954905', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4956408', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4970756', FZHYE=395.1400000000}, BalanceInfoDTO{FCUSTID='4972686', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4972928', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4973277', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4975348', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4981938', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4981939', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4986946', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4986947', FZHYE=238.1900000000}, BalanceInfoDTO{FCUSTID='4988906', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4988933', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4989019', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4989023', FZHYE=9.0000000000}, BalanceInfoDTO{FCUSTID='4989296', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4989390', FZHYE=63.0100000000}, BalanceInfoDTO{FCUSTID='4989632', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4990257', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4990387', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4990632', FZHYE=121.0000000000}, BalanceInfoDTO{FCUSTID='4994250', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4994406', FZHYE=24.5500000000}, BalanceInfoDTO{FCUSTID='4994411', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4996761', FZHYE=715.0000000000}, BalanceInfoDTO{FCUSTID='4997366', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='4997367', FZHYE=195.0200000000}, BalanceInfoDTO{FCUSTID='4998313', FZHYE=2734.4600000000}, BalanceInfoDTO{FCUSTID='5012509', FZHYE=526.8000000000}, BalanceInfoDTO{FCUSTID='5012512', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5014023', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5014184', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5014533', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5014594', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5014672', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5014674', FZHYE=150.0100000000}, BalanceInfoDTO{FCUSTID='5015101', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5020362', FZHYE=27.0100000000}, BalanceInfoDTO{FCUSTID='5020891', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5020955', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5020960', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5021184', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5023939', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5023994', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5028751', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5028752', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5028904', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5028912', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5029496', FZHYE=150.0000000000}, BalanceInfoDTO{FCUSTID='5029497', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5029512', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5029518', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5030360', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5030610', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5030659', FZHYE=664.3000000000}, BalanceInfoDTO{FCUSTID='5030711', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5031389', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5032080', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5032081', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5032279', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5032295', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5039745', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5039794', FZHYE=1573.0000000000}, BalanceInfoDTO{FCUSTID='5039795', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5039803', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5040649', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5041591', FZHYE=12.3900000000}, BalanceInfoDTO{FCUSTID='5047006', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5047009', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5047289', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5048133', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5048868', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5048887', FZHYE=-245.6000000000}, BalanceInfoDTO{FCUSTID='5048996', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5050098', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5050107', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5064166', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065342', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065345', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065515', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065546', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065581', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065611', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5065804', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5066040', FZHYE=9.0000000000}, BalanceInfoDTO{FCUSTID='5066125', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5066997', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5068696', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5068837', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5068936', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5068948', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5069916', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5079386', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5079778', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5087813', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5087904', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5088107', FZHYE=15.2000000000}, BalanceInfoDTO{FCUSTID='5088108', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5090079', FZHYE=3309.2100000000}, BalanceInfoDTO{FCUSTID='5109641', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5109647', FZHYE=366.3600000000}, BalanceInfoDTO{FCUSTID='5109648', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5111522', FZHYE=120.0000000000}, BalanceInfoDTO{FCUSTID='5115618', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5115761', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5115762', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5116238', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5122001', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5122171', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5122173', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5129163', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5129233', FZHYE=5.2000000000}, BalanceInfoDTO{FCUSTID='5129248', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5141336', FZHYE=56.0100000000}, BalanceInfoDTO{FCUSTID='5141341', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5141953', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5141965', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5141967', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5142371', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5142553', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5143210', FZHYE=-1541.4800000000}, BalanceInfoDTO{FCUSTID='5143427', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5144579', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5153201', FZHYE=138.0000000000}, BalanceInfoDTO{FCUSTID='5153265', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5154002', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5171555', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5171556', FZHYE=9.2400000000}, BalanceInfoDTO{FCUSTID='5171742', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5171743', FZHYE=168.0000000000}, BalanceInfoDTO{FCUSTID='5171746', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5171770', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5174416', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5174421', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5174491', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5174816', FZHYE=57.0400000000}, BalanceInfoDTO{FCUSTID='5177778', FZHYE=0.6000000000}, BalanceInfoDTO{FCUSTID='5177783', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5183008', FZHYE=650.0000000000}, BalanceInfoDTO{FCUSTID='5186925', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5193069', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5200229', FZHYE=-4165.0200000000}, BalanceInfoDTO{FCUSTID='5201129', FZHYE=180.0000000000}, BalanceInfoDTO{FCUSTID='5205099', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5205385', FZHYE=-5.6000000000}, BalanceInfoDTO{FCUSTID='5207791', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5207803', FZHYE=1529.2000000000}, BalanceInfoDTO{FCUSTID='5207819', FZHYE=2328.9200000000}, BalanceInfoDTO{FCUSTID='5207868', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5207919', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5208513', FZHYE=876.0000000000}, BalanceInfoDTO{FCUSTID='5212898', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5212901', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5212910', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5217309', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5217558', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5218009', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5222922', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5222978', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5222979', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5223231', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5225197', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5229618', FZHYE=20.0000000000}, BalanceInfoDTO{FCUSTID='5231541', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5233270', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5239483', FZHYE=4.5700000000}, BalanceInfoDTO{FCUSTID='5239622', FZHYE=-421.0000000000}, BalanceInfoDTO{FCUSTID='5241285', FZHYE=1463.4200000000}, BalanceInfoDTO{FCUSTID='5251172', FZHYE=96.0000000000}, BalanceInfoDTO{FCUSTID='5253813', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5259807', FZHYE=109.7000000000}, BalanceInfoDTO{FCUSTID='5260823', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5261961', FZHYE=122.0300000000}, BalanceInfoDTO{FCUSTID='5263251', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5263259', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5263771', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5263847', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5274072', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5278641', FZHYE=94.0000000000}, BalanceInfoDTO{FCUSTID='5278721', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5279742', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5282498', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5285741', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5287380', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5287975', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5294317', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5296913', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5299250', FZHYE=90.0000000000}, BalanceInfoDTO{FCUSTID='5314424', FZHYE=0.0}, BalanceInfoDTO{FCUSTID='5531105', FZHYE=-2528.7000000000}, BalanceInfoDTO{FCUSTID='5785562', FZHYE=30.0000000000}";
        a = a.replace(", FZHYE", "& FZHYE");
        String[] split = a.split(",");
        List<BalanceInfoDTO> collect = Arrays.stream(split).map(s -> {
            String replace = s.replace("BalanceInfoDTO{FCUSTID='", "");
            replace = replace.replace("FZHYE=", "");
            replace = replace.replace("}", "");
            replace = replace.replace("'", ",");
            String[] split1 = replace.split("&");
            BalanceInfoDTO infoDTO = new BalanceInfoDTO();
            infoDTO.setFCUSTID(split1[0].replace(" ", ""));
            infoDTO.setFZHYE(new BigDecimal(split1[1].replace(" ", "")));
            return infoDTO;
        }).collect(Collectors.toList());
    }

    /**
     * 批量处理数据 减少数据库交互次数 内存中处理逻辑
     * <p>
     * 感觉写复杂了
     */
    @Transactional(rollbackFor = Exception.class)
    public void syncDepositBalanceInfo(List<BalanceInfoDTO> balanceInfoDTOS) {
        try {
            List<String> erpDistributorIs =
                balanceInfoDTOS.stream().map(BalanceInfoDTO::getFCUSTID).collect(Collectors.toList());
            Map<String, Object> map = new HashMap<>(16);
            map.put("erpDistributorIs", erpDistributorIs);
            // 账户余额信息
            List<DepositDistributorDO> depositDistributorDOS = depositDistributorMapper.selectByParams(map);
            depositDistributorDOS.sort(Comparator.comparingInt(value -> Integer.parseInt(value.getErpDistributorId())));
            // 待更新的集合
            List<DepositDistributorDO> dos = new ArrayList<>();
            // 余额变化明细
            List<DepositDistributorSubsidiaryBookDO> bookDOS = new ArrayList<>();

            // 先处理交集（待更新集合中 有 余额账户的数据）!!!! 重新hashCode equals 慎用比较
            // 深拷贝
            List<BalanceInfoDTO> collect1 =
                balanceInfoDTOS.stream().map(SerializationUtils::clone).collect(Collectors.toList());
            log.info("深拷贝之后的size:{}", collect1.size());
            List<BalanceInfoDTO> collect = depositDistributorDOS.stream().map(aDo -> {
                BalanceInfoDTO infoDTO = new BalanceInfoDTO();
                infoDTO.setFCUSTID(aDo.getErpDistributorId());
                return infoDTO;
            }).collect(Collectors.toList());
            collect1.retainAll(collect);
            log.info("将要更新的 ERP余额账户：{}", JSON.toJSONString(collect1));
            for (int i = 0; i < collect1.size(); i++) {
                log.info("开始处理：{}", collect1.get(i).getFCUSTID());
                // erp 同步来的余额
                BalanceInfoDTO dto = collect1.get(i);
                log.info("ERP同步来的余额:{}", JSON.toJSONString(dto));
                // 数据库中的余额
                DepositDistributorDO depositDistributorDO = depositDistributorDOS.get(i);
                log.info("数据库中的余额：{}", JSON.toJSONString(depositDistributorDO));
                BigDecimal subtract = dto.getFZHYE().subtract(depositDistributorDO.getAccountBalance());
                log.info("差额：{}", subtract);
                if (subtract.compareTo(BigDecimal.ZERO) != 0) {
                    // 余额直接覆盖
                    BigDecimal old = depositDistributorDO.getAccountBalance();
                    depositDistributorDO.setAccountBalance(dto.getFZHYE());
                    // 可用余额 = ERP同步金额 - 原有冻结金额
                    depositDistributorDO
                        .setAccountAvailable(dto.getFZHYE().subtract(depositDistributorDO.getFreezingAmount()));
                    DepositDistributorSubsidiaryBookDO aDo = new DepositDistributorSubsidiaryBookDO();
                    aDo.setDepositDistributorId(depositDistributorDO.getId());
                    aDo.setDistributorId(depositDistributorDO.getDistributorId());
                    aDo.setDistributorName(depositDistributorDO.getDistributorName());
                    aDo.setBusinessType(DepositBusinessType.ERP_TOTAL);
                    aDo.setBusinessId(null);
                    if (subtract.compareTo(BigDecimal.ZERO) > 0) {
                        aDo.setChangeType(ChangeType.INCREASE);
                    } else if (subtract.compareTo(BigDecimal.ZERO) < 0) {
                        aDo.setChangeType(ChangeType.DECREASE);
                    }
                    aDo.setAmount(subtract);
                    aDo.setBeforeDepositAmount(old);
                    aDo.setAfterDepositAmount(dto.getFZHYE());
                    aDo.setRemark("erp余额全量更新");
                    aDo.setCreateTime(new Date());
                    bookDOS.add(aDo);
                    dos.add(depositDistributorDO);
                }
            }
            // 处理新增余额账户的情况
            balanceInfoDTOS.removeAll(collect1);
            log.info("将要新增的 ERP余额账户：{}", JSON.toJSONString(balanceInfoDTOS));
            if (!CollectionUtils.isEmpty(balanceInfoDTOS)) {
                List<Integer> erpIds = balanceInfoDTOS.stream()
                    .map(balanceInfoDTO -> Integer.valueOf(balanceInfoDTO.getFCUSTID())).collect(Collectors.toList());
                // 根据分销商内码获取 分销商相关信息
                List<DistributorNextNameRpcDTO> distributorNextByErpIds =
                    distributorServiceRpc.getDistributorNextByErpIds(erpIds);
                log.info("distributorNextByErpIds:{}", JSON.toJSONString(distributorNextByErpIds));
                balanceInfoDTOS.forEach(balanceInfoDTO -> {
                    // 从返回的分销商中根据分销商内码进行匹配创建对象
                    log.info("balanceInfoDTO:{}", JSON.toJSONString(balanceInfoDTO));
                    DistributorNextNameRpcDTO distributorNextNameRpcDTO1 =
                        distributorNextByErpIds.stream().filter(distributorNextNameRpcDTO -> distributorNextNameRpcDTO
                            .getErpId().equals(Integer.valueOf(balanceInfoDTO.getFCUSTID()))).findFirst().orElse(null);
                    if (distributorNextNameRpcDTO1 != null) {
                        // 组装
                        DepositDistributorDO aDo = initNewDepositDistributor(distributorNextNameRpcDTO1.getId(),
                            distributorNextNameRpcDTO1.getName(), balanceInfoDTO.getFCUSTID(),
                            distributorNextNameRpcDTO1.getTreeNode(),
                            distributorNextNameRpcDTO1.getDistributorAncestorId(),
                            distributorNextNameRpcDTO1.getDistributorAncestorName());
                        Date date = new Date();
                        aDo.setAccountBalance(balanceInfoDTO.getFZHYE());
                        aDo.setAccountAvailable(balanceInfoDTO.getFZHYE());
                        aDo.setCreateTime(date);
                        aDo.setUpdateTime(date);
                        log.info("inset new account :{}", aDo);
                        createNewDepositDistributor(aDo);
                        DepositDistributorSubsidiaryBookDO bookDO = new DepositDistributorSubsidiaryBookDO();
                        bookDO.setDepositDistributorId(aDo.getId());
                        bookDO.setDistributorId(distributorNextNameRpcDTO1.getId());
                        bookDO.setDistributorName(distributorNextNameRpcDTO1.getName());
                        bookDO.setBusinessType(DepositBusinessType.ERP_TOTAL);
                        bookDO.setPayWay(PayWay.BALANCE);
                        bookDO.setBusinessId(null);
                        bookDO.setChangeType(ChangeType.INCREASE);
                        bookDO.setAmount(balanceInfoDTO.getFZHYE());
                        bookDO.setBeforeDepositAmount(BigDecimal.ZERO);
                        bookDO.setAfterDepositAmount(balanceInfoDTO.getFZHYE());
                        bookDO.setRemark("erp余额全量更新");
                        bookDO.setCreateTime(date);
                        bookDOS.add(bookDO);
                    } else {
                        log.info("balanceInfoDTO error null!!!!!!!!!!!:{}", JSON.toJSONString(balanceInfoDTO));
                    }
                });
            }
            log.info("实际更新的账户余额 size:{},date:{}", dos.size(), dos.toString());
            log.info("实际新增的变更明细 size:{},date:{}", bookDOS.size(), bookDOS.toString());
            if (!CollectionUtils.isEmpty(dos)) {
                depositDistributorMapper.updateBatchByPrimaryKey(dos);
            }
            if (!CollectionUtils.isEmpty(bookDOS)) {
                depositDetailCmdExc.insertBatch(bookDOS);
            }
        } catch (Exception e) {
            e.printStackTrace();
            throw e;
        }
    }

}
